CREATE DATABASE MovingData


USE MovingData
GO


CREATE TABLE Moving (
JobNumber smallint NOT NULL PRIMARY KEY,
Name varchar (30) NOT NULL,
LastName varchar (30) NOT NULL,
Date DATE,
CubicFoot smallint NOT NULL,
Income smallmoney NOT NULL,
MoversCommission AS (Income*0.385),
OtherExpenses AS (Income*0.3)
)

CREATE TABLE MovingInfo (
JobNumber smallint NOT NULL PRIMARY KEY,
PickUpNeighborhood varchar (30) NOT NULL,
PickUpState varchar (14) NOT NULL,
DropOffNeighborhood varchar (30),
DropOffState varchar (14),
StairsOnPickUp varchar (3) NOT NULL CHECK (StairsOnPickUp IN ('Yes', 'No')),
StairsOnDropOff varchar (3) NOT NULL CHECK (StairsOnDropOff IN ('Yes', 'No')),
Review varchar (1) CHECK (Review BETWEEN 1 AND 5)
)


INSERT INTO Moving (JobNumber, Name, LastName, Date, CubicFoot, Income)
VALUES (1, 'Mary', 'Martinez', '2022-11-15', 941, 1600),
(2, 'Mary', 'Brown', '2023-06-25', 732, 1200),
(3, 'Michael', 'Garcia', '2022-03-14', 710, 1234),
(4, 'Mary', 'Smith', '2022-08-03', 1142, 2125),
(5, 'Mary', 'Garcia', '2024-01-14', 752, 1000),
(6, 'James', 'Johnson', '2023-01-20', 1150, 2023),
(7, 'Patricia', 'Miller', '2022-05-11', 485, 699),
(8, 'Robert', 'Davis', '2023-11-03', 950, 1015),
(9, 'Jennifer', 'Rodriguez', '2022-07-22', 367, 367),
(10, 'William', 'Smith', '2023-03-15', 1234, 1771),
(11, 'John', 'Williams', '2023-02-17', 998, 758),
(12, 'Elizabeth', 'Brown', '2022-04-21', 634, 789),
(13, 'William', 'Johnson', '2023-07-30', 789, 999),
(14, 'Jennifer', 'Davis', '2022-06-15', 567, 901),
(15, 'Michael', 'Rodriguez', '2023-09-10', 456, 599),
(16, 'Patricia', 'Smith', '2022-12-22', 1120, 1399),
(17, 'Robert', 'Martinez', '2023-05-18', 825, 999),
(18, 'Linda', 'Garcia', '2022-03-29', 390, 666),
(19, 'James', 'Miller', '2023-08-05', 550, 719),
(20, 'Mary', 'Jones', '2022-11-11', 950, 999),
(30, 'William', 'Garcia', '2024-01-13', 500, 615),
(31, 'John', 'Johnson', '2023-06-07', 449, 830),
(32, 'John', 'Johnson', '2023-12-10', 180, 325),
(33, 'Linda', 'Williams', '2022-08-21', 1217, 1880),
(34, 'William', 'Garcia', '2022-06-20', 955, 1212),
(35, 'Michael', 'Brown', '2024-01-04', 341, 549),
(36, 'Jennifer', 'Williams', '2022-11-28', 1221, 1746),
(37, 'James', 'Brown', '2023-11-08', 1217, 1499),
(38, 'John', 'Garcia', '2023-11-22', 601, 699),
(39, 'Michael', 'Davis', '2023-11-05', 221, 399),
(40, 'Patricia', 'Garcia', '2022-10-30', 828, 999),
(41, 'Jennifer', 'Miller', '2023-09-03', 1342, 1699),
(42, 'William', 'Williams', '2022-12-25', 784, 850),
(43, 'Jennifer', 'Garcia', '2024-02-03', 1405, 1788),
(44, 'Patricia', 'Williams', '2023-07-28', 1357, 1500),
(45, 'James', 'Jones', '2023-04-07', 350, 466),
(46, 'Linda', 'Miller', '2023-06-12', 821, 999),
(47, 'John', 'Garcia', '2024-01-01', 1473, 1200),
(48, 'Robert', 'Johnson', '2022-03-29', 752, 750),
(49, 'Mary', 'Brown', '2022-08-19', 252, 318),
(50, 'John', 'Smith', '2023-08-20', 308, 299),
(51, 'Robert', 'Garcia', '2022-07-04', 505, 499),
(52, 'Mary', 'Williams', '2023-07-13', 894, 894),
(53, 'Michael', 'Johnson', '2022-07-18', 806, 806),
(54, 'William', 'Jones', '2024-01-04', 1068, 1267),
(55, 'Jennifer', 'Brown', '2022-01-07', 808, 999),
(56, 'Mary', 'Miller', '2022-12-17', 1422, 1200),
(57, 'Patricia', 'Brown', '2022-10-05', 270, 350),
(58, 'Patricia', 'Williams', '2023-02-16', 933, 999),
(59, 'Michael', 'Smith', '2023-02-18', 1293, 1515),
(60, 'Mary', 'Williams', '2023-06-21', 921, 999),
(61, 'Linda', 'Miller', '2023-08-02', 484, 484),
(62, 'Linda', 'Smith', '2023-12-23', 895, 850),
(63, 'Robert', 'Jones', '2022-06-28', 892, 999),
(64, 'Robert', 'Williams', '2022-07-13', 237, 299),
(65, 'Linda', 'Johnson', '2023-05-21', 1487, 1700),
(66, 'William', 'Jones', '2023-01-28', 1108, 999),
(67, 'Michael', 'Garcia', '2023-03-12', 196, 389),
(68, 'James', 'Davis', '2022-05-24', 804, 899),
(69, 'Robert', 'Johnson', '2022-01-07', 1252, 1600),
(70, 'John', 'Brown', '2022-05-31', 1209, 1499),
(71, 'Linda', 'Miller', '2022-12-02', 763, 880),
(72, 'Linda', 'Smith', '2023-12-12', 1272, 1420),
(73, 'Michael', 'Johnson', '2023-08-31', 765, 850),
(74, 'Linda', 'Smith', '2022-09-04', 349, 349),
(75, 'Linda', 'Jones', '2024-01-26', 565, 699),
(76, 'John', 'Smith', '2023-01-07', 523, 699),
(77, 'Elizabeth', 'Smith', '2023-04-29', 389, 499),
(78, 'James', 'Smith', '2023-12-26', 489, 489),
(79, 'Linda', 'Williams', '2023-01-31', 1412, 1700),
(80, 'Mary', 'Martinez', '2022-01-12', 1461, 1698),
(81, 'Linda', 'Miller', '2022-04-19', 1083, 1183),
(82, 'Patricia', 'Johnson', '2023-08-12', 526, 626),
(83, 'Linda', 'Rodriguez', '2022-09-27', 976, 776),
(84, 'William', 'Martinez', '2024-02-02', 1276, 1076),
(85, 'John', 'Jones', '2022-03-24', 441, 350),
(86, 'Mary', 'Davis', '2024-01-05', 1325, 1525),
(87, 'Elizabeth', 'Johnson', '2023-04-26', 699, 699),
(88, 'Linda', 'Jones', '2023-07-16', 1101, 1000),
(89, 'Elizabeth', 'Miller', '2023-03-21', 1025, 999),
(90, 'John', 'Rodriguez', '2023-04-08', 189, 350),
(91, 'William', 'Williams', '2022-09-05', 1329, 1599),
(92, 'Jennifer', 'Garcia', '2022-08-15', 882, 999),
(93, 'Patricia', 'Jones', '2023-04-07', 503, 699),
(94, 'Mary', 'Miller', '2022-08-04', 581, 699),
(95, 'Patricia', 'Smith', '2023-05-05', 389, 599),
(96, 'William', 'Martinez', '2023-08-02', 983, 1200),
(97, 'Robert', 'Davis', '2023-05-15', 885, 999),
(98, 'Linda', 'Martinez', '2023-09-18', 1010, 999),
(99, 'Linda', 'Garcia', '2022-12-06', 303, 399),
(100, 'Patricia', 'Davis', '2022-10-13', 719, 699),
(101, 'Mary', 'Smith', '2023-08-03', 1142, 2025),
(102, 'John', 'Garcia', '2024-02-01', 1473, 1300),
(103, 'Robert', 'Jones', '2023-06-28', 892, 892),
(104, 'Linda', 'Miller', '2023-05-01', 1483, 1383),
(105, 'John', 'Brown', '2023-05-31', 999, 1199),
(106, 'John', 'Brown', '2023-05-31', 999, 1199),
(107, 'Elizabeth', 'Johnson', '2024-01-01', 1199, 1099);


INSERT INTO MovingInfo (JobNumber, PickUpNeighborhood, PickUpState, DropOffNeighborhood, DropOffState,
StairsOnPickUp, StairsOnDropOff, Review)
VALUES (1, 'Soho', 'New York', 'East Village', 'New York', 'No', 'Yes', 5),
(2, 'Financial District', 'NY', 'Soho', 'NY', 'No', 'No', 4),
(3, 'Upper East Side', 'NY', 'Tribeca', 'NY', 'Yes', 'Yes', 4),
(4, 'Chelsea', 'NY', 'Harlem', 'NY', 'Yes', 'Yes', 4),
(5, 'Soho', 'NY', 'Soho', 'NY', 'No', 'No', 5),
(6, 'Midtown', 'NY', 'Chelsea', 'NY', 'Yes', 'No', 5),
(7, 'Tribeca', 'NY', 'Upper East Side', 'NY', 'No', 'Yes', 5),
(8, 'Harlem', 'NY', 'Brooklyn Heights', 'NY', 'Yes', 'No', 5),
(9, 'Soho', 'NY', 'Greenwich Village', 'NY', 'No', 'Yes', 5),
(10, 'East Village', 'NY', 'Financial District', 'NY', 'Yes', 'No', 4),
(11, 'Chelsea', 'NY', 'Midtown', 'NY', 'No', 'No', 5),
(12, 'Greenwich Village', 'NY', 'Tribeca', 'NY', 'Yes', 'Yes', 4),
(13, 'Financial District', 'NY', 'Harlem', 'NY', 'No', 'No', 5),
(14, 'Upper East Side', 'NY', 'Soho', 'NY', 'Yes', 'Yes', 5),
(15, 'Brooklyn Heights', 'NY', 'East Village', 'NY', 'No', 'Yes', 5),
(16, 'Midtown', 'NY', 'Chelsea', 'NY', 'Yes', 'No', 5),
(17, 'Tribeca', 'NY', 'Upper East Side', 'NY', 'No', 'Yes', 5),
(18, 'Harlem', 'NY', 'Brooklyn Heights', 'NY', 'Yes', 'No', 4),
(19, 'Greenwich Village', 'NY', 'Greenwich Village', 'NY', 'No', 'Yes', 5),
(20, 'East Village', 'NY', 'Financial District', 'NY', 'Yes', 'No', 4),
(21, 'Chelsea', 'NY', 'Chelsea', 'NY', 'No', 'No', 5),
(22, 'Greenwich Village', 'NY', 'Tribeca', 'NY', 'Yes', 'Yes', 4),
(23, 'Financial District', 'NY', 'Harlem', 'NY', 'No', 'No', 5),
(24, 'Upper East Side', 'NY', 'Soho', 'NY', 'Yes', 'Yes', 1),
(25, 'Brooklyn Heights', 'NY', 'East Village', 'NY', 'No', 'Yes', 5),
(26, 'Midtown', 'NY', 'Chelsea', 'NY', 'Yes', 'No', 4),
(27, 'Tribeca', 'NY', 'Upper East Side', 'NY', 'No', 'Yes', 5),
(28, 'Harlem', 'NY', 'Brooklyn Heights', 'NY', 'Yes', 'No', 1),
(29, 'Soho', 'NY', 'Greenwich Village', 'NY', 'No', 'Yes', 5),
(30, 'East Village', 'NY', 'Financial District', 'NY', 'Yes', 'No', 4),
(31, 'Harlem', 'NY', 'Tribeca', 'NY', 'No', 'Yes', 5),
(32, 'Chelsea', 'NY', 'Tribeca', 'NY', 'Yes', 'Yes', 4),
(33, 'Tribeca', 'NY', 'Tribeca', 'NY', 'Yes', 'No', 5),
(34, 'Chelsea', 'NY', 'Upper East Side', 'NY', 'Yes', 'No', 4),
(35, 'East Village', 'NY', 'Financial District', 'NY', 'No', 'No', 5),
(36, 'Tribeca', 'NY', 'Chelsea', 'NY', 'Yes', 'Yes', 5),
(37, 'East Village', 'NY', 'Tribeca', 'NY', 'Yes', 'Yes', 5),
(38, 'Greenwich Village', 'NY', 'Midtown', 'NY', 'No', 'Yes', 5),
(39, 'Chelsea', 'NY', 'Harlem', 'NY', 'Yes', 'Yes', 5),
(40, 'Tribeca', 'NY', 'Tribeca', 'NY', 'No', 'No', 5),
(41, 'Greenwich Village', 'NY', 'Midtown', 'NY', 'Yes', 'No', 5),
(42, 'Tribeca', 'NY', 'Brooklyn Heights', 'NY', 'Yes', 'No', 5),
(43, 'Soho', 'NY', 'Financial District', 'NY', 'Yes', 'No', 5),
(44, 'Chelsea', 'NY', 'Chelsea', 'NY', 'No', 'Yes', 5),
(45, 'Midtown', 'NY', 'Soho', 'NY', 'No', 'Yes', 5),
(46, 'Brooklyn Heights', 'NY', 'Financial District', 'NY', 'No', 'Yes', 4),
(47, 'Chelsea', 'NY', 'Soho', 'NY', 'No', 'Yes', 5),
(48, 'Soho', 'NY', 'East Village', 'NY', 'No', 'Yes', 5),
(49, 'Financial District', 'NY', 'Upper East Side', 'NY', 'Yes', 'Yes', 4),
(50, 'Brooklyn Heights', 'NY', 'Tribeca', 'NY', 'Yes', 'No', 5),
(51, 'Upper East Side', 'NY', 'Chelsea', 'NY', 'Yes', 'Yes', 3),
(52, 'Soho', 'NY', 'Soho', 'NY', 'No', 'No', 5),
(53, 'Greenwich Village', 'NY', 'Greenwich Village', 'NY', 'No', 'Yes', 5),
(54, 'Chelsea', 'NY', 'Upper East Side', 'NY', 'Yes', 'No', 5),
(55, 'Midtown', 'NY', 'Tribeca', 'NY', 'Yes', 'Yes', 5),
(56, 'Harlem', 'NY', 'Chelsea', 'NY', 'No', 'Yes', 3),
(57, 'Tribeca', 'NY', 'Soho', 'NY', 'No', 'No', 5),
(58, 'Harlem', 'NY', 'Brooklyn Heights', 'NY', 'No', 'No', 5),
(59, 'Greenwich Village', 'NY', 'Tribeca', 'NY', 'Yes', 'No', 5),
(60, 'Financial District', 'NY', 'Harlem', 'NY', 'No', 'No', 1),
(61, 'Greenwich Village', 'NY', 'Financial District', 'NY', 'No', 'Yes', 5),
(62, 'Midtown', 'NY', 'Financial District', 'NY', 'No', 'Yes', 5),
(63, 'Harlem', 'NY', 'Tribeca', 'NY', 'Yes', 'Yes', 5),
(64, 'Soho', 'NY', 'Greenwich Village', 'NY', 'Yes', 'No', 4),
(65, 'Chelsea', 'NY', 'Upper East Side', 'NY', 'No', 'Yes', 5),
(66, 'Chelsea', 'NY', 'Financial District', 'NY', 'Yes', 'Yes', 5),
(67, 'Financial District', 'NY', 'East Village', 'NY', 'Yes', 'No', 5),
(68, 'Midtown', 'NY', 'Soho', 'NY', 'No', 'Yes', 5),
(69, 'Upper East Side', 'NY', 'Upper East Side', 'NY', 'Yes', 'Yes', 5),
(70, 'Midtown', 'NY', 'Soho', 'NY', 'No', 'Yes', 5),
(71, 'East Village', 'NY', 'Upper East Side', 'NY', 'Yes', 'No', 5),
(72, 'Chelsea', 'NY', 'Harlem', 'NY', 'No', 'No', 5),
(73, 'Greenwich Village', 'NY', 'Tribeca', 'NY', 'Yes', 'No', 5),
(74, 'Chelsea', 'NY', 'Financial District', 'NY', 'Yes', 'Yes', 5),
(75, 'Brooklyn Heights', 'NY', 'Tribeca', 'NY', 'No', 'No', 5),
(76, 'Upper East Side', 'NY', 'Chelsea', 'NY', 'Yes', 'Yes', 3),
(77, 'Soho', 'NY', 'Greenwich Village', 'NY', 'Yes', 'No', 5),
(78, 'Soho', 'NY', 'Tribeca', 'NY', 'Yes', 'No', 2),
(79, 'Soho', 'NY', 'Financial District', 'NY', 'Yes', 'No', 5),
(80, 'Harlem', 'NY', 'Harlem', 'NY', 'Yes', 'No', 5),
(81, 'Tribeca', 'NY', 'Tribeca', 'NY', 'No', 'No', 5),
(82, 'Soho', 'NY', 'Soho', 'NY', 'No', 'Yes', 1),
(83, 'Greenwich Village', 'NY', 'Brooklyn Heights', 'NY', 'Yes', 'Yes', 5),
(84, 'Greenwich Village', 'NY', 'Harlem', 'NY', 'No', 'No', 5),
(85, 'Midtown', 'NY', 'East Village', 'NY', 'No', 'Yes', 5),
(86, 'East Village', 'NY', 'Financial District', 'NY', 'No', 'Yes', 5),
(87, 'Tribeca', 'NY', 'Financial District', 'NY', 'No', 'No', 5),
(88, 'Greenwich Village', 'NY', 'Brooklyn Heights', 'NY', 'Yes', 'No', 5),
(89, 'Midtown', 'NY', 'Midtown', 'NY', 'Yes', 'Yes', 5),
(90, 'Harlem', 'NY', 'Greenwich Village', 'NY', 'No', 'Yes', 5),
(91, 'Midtown', 'NY', 'Financial District', 'NY', 'No', 'Yes', 5),
(92, 'Greenwich Village', 'NY', 'Brooklyn Heights', 'NY', 'No', 'No', 5),
(93, 'Midtown', 'NY', 'Harlem', 'NY', 'Yes', 'Yes', 3),
(94, 'East Village', 'NY', 'East Village', 'NY', 'No', 'No', 3),
(95, 'Greenwich Village', 'NY', 'Soho', 'NY', 'Yes', 'Yes', 5),
(96, 'Greenwich Village', 'NY', 'Harlem', 'NY', 'Yes', 'No', 5),
(97, 'Chelsea', 'NY', 'Greenwich Village', 'NY', 'No', 'Yes', 5),
(98, 'Tribeca', 'NY', 'Upper East Side', 'NY', 'Yes', 'No', 5),
(99, 'Tribeca', 'NY', 'Soho', 'NY', 'Yes', 'Yes', 5),
(100, 'Tribeca', 'NY', 'Midtown', 'NY', 'No', 'No', 5),
(101, 'Harlem', 'NY', 'Chelsea', 'NY', 'Yes', 'Yes', 4),
(102, 'Chelsea', 'NY', 'Soho', 'NY', 'Yes', 'Yes', 5),
(103, 'Tribeca', 'NY', 'Soho', 'NY', 'Yes', 'Yes', 5),
(104, 'Soho', 'NY', 'Greenwich Village', 'NY', 'No', 'Yes', 5),
(105, 'Soho', 'NY', 'Midtown', 'NY', 'No', 'Yes', 5),
(106, 'Midtown', 'NY', 'Midtown', 'NY', 'No', 'Yes', 5),
(107, 'Financial District', 'NY', 'Financial District', 'NY', 'No', 'No', 5);


SELECT * FROM Moving
SELECT * FROM MovingInfo


UPDATE MovingInfo SET PickUpNeighborhood = 'Dixwell', PickUpState = 'CT', DropOffNeighborhood = 'Soho', DropOffState = 'NY' WHERE JobNumber = 2;
UPDATE MovingInfo SET PickUpNeighborhood = 'Soho', PickUpState = 'NY', DropOffNeighborhood = 'Dixwell', DropOffState = 'CT' WHERE JobNumber = 9;
UPDATE MovingInfo SET PickUpNeighborhood = 'South Philadelphia', PickUpState = 'PA', DropOffNeighborhood = 'South Philadelphia', DropOffState = 'PA' WHERE JobNumber = 16;
UPDATE MovingInfo SET PickUpNeighborhood = 'Bayonne', PickUpState = 'NJ', DropOffNeighborhood = 'Bayonne', DropOffState = 'NJ' WHERE JobNumber = 17;
UPDATE MovingInfo SET PickUpNeighborhood = 'South Philadelphia', PickUpState = 'PA', DropOffNeighborhood = 'Financial District', DropOffState = 'NY' WHERE JobNumber = 20;
UPDATE MovingInfo SET PickUpNeighborhood = 'Jersey City', PickUpState = 'NJ', DropOffNeighborhood = 'Tribeca', DropOffState = 'NY' WHERE JobNumber = 40;
UPDATE MovingInfo SET PickUpNeighborhood = 'Hoboken', PickUpState = 'NJ', DropOffNeighborhood = 'Soho', DropOffState = 'NY' WHERE JobNumber = 68;
UPDATE MovingInfo SET PickUpNeighborhood = 'Soho', PickUpState = 'NY', DropOffNeighborhood = 'Hoboken', DropOffState = 'NJ' WHERE JobNumber = 78;
UPDATE MovingInfo SET PickUpNeighborhood = 'Jersey City', PickUpState = 'NJ', DropOffNeighborhood = 'Brooklyn Heights', DropOffState = 'NY' WHERE JobNumber = 83;
UPDATE MovingInfo SET PickUpNeighborhood = 'Greenwich Village', PickUpState = 'NY', DropOffNeighborhood = 'Brooklyn Heights', DropOffState = 'NJ' WHERE JobNumber = 92;


SELECT * FROM MovingInfo
